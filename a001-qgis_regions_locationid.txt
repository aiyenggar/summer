Iteration 4, Dated 2017-01-18 (Using Urban Areas alone)
I take the natural earth urban centers data from http://www.naturalearthdata.com/downloads/10m-cultural-vectors/ with the specific link being
http://www.naturalearthdata.com/http//www.naturalearthdata.com/download/10m/cultural/ne_10m_urban_areas_landscan.zip

I copied all files to the parent folder ~/OneDrive/gis renamed all files as urban_areas. Then I opened urban_areas.shp in QGIS, deleted all but three  fields: name_conve, max_pop_al, min_areakm. Save the file changed the field name of name_conve as region, max_pop_al as pop and min_areakm as areakm.

Old stuff - should no longer be needed

Selected all observations (some 6000 odd), and set the region to the be same as the name. Then deleted name, and saved the file. The question is if there are overlapping areas - like maybe Newark is its own but also part of New York. Not sure.

Iteration 3, Dated 2017-01-03 (changed desitnation locations)
Objective: Create a single shape file with all the urban centers in the world. Yes, I may intend to only study a few regions now, but it does not hurt to have the larger list. A special case needs to be made for the US, where Metropolitan Statistical Areas (MSAs) are used, elsewhere we default to natural earth’s urban definitions.

To do this, I first take the US MSA data from Metropolitan Statistical Areas https://www.census.gov/geo/maps-data/data/cbf/cbf_msa.html. The specific package is cb_2015_us_cbsa_20m. On this data, I add a new field called Region and set it to the same value as the NAME field, and then delete all other fields. I save this layer as us_metro

Next, I take the natural earth urban centers data from http://www.naturalearthdata.com/downloads/10m-cultural-vectors/ with the specific link being
http://www.naturalearthdata.com/http//www.naturalearthdata.com/download/10m/cultural/ne_10m_urban_areas_landscan.zip 
So as to not repeat US locations, I need to eliminate all US regions from this file. I did this manually, but there should be a better way to intersect the US country boundary to do this. Again on this data, I add a field called Region and set it to the value as in name_conve (not fully sure), then delete all other fields.

I then set the CRS of both to WRS84
Then use Vector -> Data Management  Tools -> Merge Shapefiles to create a single world wide shapefile for all urban centres, with the US locations being based on MSA definition, and all others based on natural earth’s definition. I save this shape file as merged_usmsa_worldurban.shp

The regions of immediate interest to me are:
Tel Aviv-Yafo
Jerusalem
Bangalore
Beijing
Boston-Cambridge-Newton, MA-NH
Austin-Round Rock, TX
San Francisco-Oakland-Hayward, CA
San Jose-Sunnyvale-Santa Clara, CA



In QGIS - Create a Layer from a Delimited Text File, 
Layer - Add Layer - Create a layer from a delimited text file
~/OneDrive/data/patentsview/location.tsv Let the X: Longitude and Y: Latitude be as default. Set CRS to WGS84 EPSG:4326 (was previously World Geodetic System 1984 IGNF:WBS84G)

Open urban_areas.shp (merged_usmsa_worldurban.shp) file

Vector -> Data Management Tools -> Join Attributes by Location
I have changed the order this time, as I didn’t get the whole list last time
Target vector layer (Location)
Join vector layer urban_areas (merged_usmsa_worldurban)
Geometric Predicate (intersects)
Precision - Leave at 0
Attribute Summary - Take attributes of the first located feature
Statistics for summary - Delete all (and leave blank)
Joined table - Keep all records (including non-matching target records)

This will take a few (12) hours, then say yes to if you would like to add the layer to TOC. Choose the CRS as above. I save this as locationid_urban_areas (regions_usmsa_worldurban_100k)

Open the attribute table, select all. Now go back to the map, right click on the layer and save as -> Format: Comma Separated Value [CSV] and save as ~/OneDrive/data/patentsview/locationid_urban_areas.csv (~/OneDrive/data/patentsview/locationid_region.csv)

{8-Dec-2016 - Not sure if I need this anymore:
Add an additional line at the end: missing_location_id,DataUnavailable and}


